webpackJsonp([1],{0:function(t,e,i){i(118),i(119),i(120),i(121),i(122),i(123),i(124),i(125),t.exports=i(101)},25:function(t,e,i){"use strict";var n=i(55),s=i(54),r={addItem:function(t){n.handleViewAction({actionType:s.ADD_ITEM,item:t})},bpmChange:function(t){n.handleViewAction({actionType:s.CHANGE_BPM,item:t})},bitPushed:function(t){n.handleViewAction({actionType:s.BIT_PUSHED,bitpushed:t})},setCurrentTime:function(t){n.handleViewAction({actionType:s.SET_CURRENTTIME,item:t})},pausedtimeChange:function(t){n.handleViewAction({actionType:s.CHANGE_PAUSEDTIME,item:t})},playDrumKit:function(){n.handleViewAction({actionType:s.PLAY_DRUMKIT})},stopDrumKit:function(){n.handleViewAction({actionType:s.STOP_DRUMKIT})},changeBit:function(t,e,i){n.handleViewAction({actionType:s.CHANGE_BIT,instrument:t,bitindex:e,bit:i})},loadDrumKit:function(){n.handleViewAction({actionType:s.LOAD_DRUMKIT})},timeChange:function(t){n.handleViewAction({actionType:s.CHANGE_TIME,item:t})}};t.exports=r},54:function(t,e){"use strict";t.exports={CHANGE_TIME:"CHANGE_TIME",CHANGE_BPM:"CHANGE_BPM",PLAY_DRUMKIT:"PLAY_DRUMKIT",LOAD_DRUMKIT:"LOAD_DRUMKIT",CHANGE_BIT:"CHANGE_BIT",SET_CURRENTTIME:"SET_CURRENTTIME",CHANGE_PAUSEDTIME:"CHANGE_PAUSEDTIME",STOP_DRUMKIT:"STOP_DRUMKIT",ADD_ITEM:"ADD_ITEM",REMOVE_ITEM:"REMOVE_ITEM",BIT_PUSHED:"BIT_PUSHED"}},55:function(t,e,i){"use strict";var n=i(126).Dispatcher,s=i(63),r=s(new n,{handleViewAction:function(t){this.dispatch({source:"DRUMKIT_ACTION",action:t})}});t.exports=r},56:function(t,e,i){"use strict";function n(){try{window.AudioContext=window.AudioContext||window.webkitAudioContext,p=new AudioContext}catch(t){alert("Web Audio API is not supported in this browser")}}function s(t,e){var i=p.createBufferSource();i.buffer=t,i.connect(p.destination),i.start(e)}function r(){for(var t=0;t<D.instruments.length;t++)a(D.instruments[t].soundurl),console.log(D.instruments[t].name+" chargÃ©")}function a(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){p.decodeAudioData(e.response,function(t){P.push(t)},function(t){console.error("decodeAudioData error",t)})},e.send()}function o(){D.bitnumber=parseInt(D.bpm)*parseInt(D.time)/60;for(var t=0;t<D.instruments.length;t++){console.log("Nombre de bits: "+D.bitnumber);for(var e=0;e<D.bitnumber;e++)"undefined"==typeof D.instruments[t].bits[e]&&D.instruments[t].bits.push(0),D.bitnumber<D.instruments[t].bits.length&&D.instruments[t].bits.splice(D.bitnumber,1)}}function c(){B=p.currentTime-k+B,N=0,D.elapsedtime=0,B=0,A.emitPausedTime(),A.emitCurrentBit(),clearTimeout(f)}function u(){b=0,k=p.currentTime+.005,l()}function l(){var t=p.currentTime;for(t-=k;t+.2>b;){var e=b+k;A.emitCurrentBit(),D.elapsedtime=t+B,A.emitPausedTime();for(var i=0;i<D.instruments.length;i++)1==D.instruments[i].bits[N]&&s(P[i],e);h()}f=setTimeout(l,0)}function h(){var t=60/D.bpm;N++,console.log("currentBit: "+N),console.log("bitnumber: "+D.bitnumber),N==D.bitnumber&&c(),b+=t}function m(t,e,i){1==i&&s(P[t],0)}function d(){$.ajax({url:"/api/getdrumkit",dataType:"json",cache:!1,success:function(t){D.bpm=t.bpm,D.time=t.time,D.instruments=t.instruments,o(),A.emitChange()}.bind(this),error:function(t,e,i){console.error(this.props.url,e,i.toString())}.bind(this)})}var p,f,b,g=i(55),v=i(54),_=i(102).EventEmitter,E=i(63),y="change",C="newbit",T="timechanged",x="bitupdated",w="bitpushed",D={bpm:0,time:0,bitnumber:0,elapsedtime:0,instruments:[]},N=0,I=0,P=[],k=0,B=0,A=E({},_.prototype,{getDrumKitInfos:function(){return D},getCurrentBit:function(){return N},getBitPushed:function(t){return I},getBitsInstrument:function(t){return D.instruments[t].bits},emitCurrentBit:function(){this.emit(C)},addBitListener:function(t){this.on(C,t)},emitBitUpdated:function(){this.emit(x)},addBitPushedListener:function(t){this.on(w,t)},emitBitPushed:function(){this.emit(w)},addBitUpdatedListener:function(t){this.on(x,t)},getCurrentTime:function(){return D.elapsedtime},emitPausedTime:function(){this.emit(T)},addPausedsedTimeListener:function(t){this.on(T,t)},emitChange:function(){this.emit(y)},addChangedListener:function(t){this.on(y,t)}});g.register(function(t){var e=t.action;switch(e.actionType){case v.CHANGE_TIME:console.log(e.item),D.time=e.item,o(),A.emitChange();break;case v.CHANGE_BPM:D.bpm=e.item,o(),A.emitChange();break;case v.CHANGE_BIT:D.instruments[e.instrument].bits[e.bitindex]=e.bit,m(e.instrument,e.bitindex,e.bit),A.emitBitUpdated();break;case v.CHANGE_PAUSEDTIME:B=e.item,A.emitPausedTime();break;case v.LOAD_DRUMKIT:d(),A.emitChange();break;case v.SET_CURRENTTIME:A.emitPausedTime(),D.elapsedtime=t.action.item;break;case v.BIT_PUSHED:I=e.bitpushed,A.emitBitPushed(),console.log(e);break;case v.PLAY_DRUMKIT:u();break;case v.STOP_DRUMKIT:c();break;case v.ADD_ITEM:n(),r(),A.emitChange()}return!0}),t.exports=A},63:function(t,e){"use strict";function i(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=Object.assign||function(t,e){for(var n,s,r,a=i(t),o=1;o<arguments.length;o++){s=arguments[o],r=Object.keys(Object(s));for(var c=0;c<r.length;c++)try{a[r[c]]=s[r[c]]}catch(u){void 0===n&&(n=u)}}if(n)throw n;return a}},94:function(t,e,i){"use strict";var n=i(13),s=n.createClass({displayName:"CurrentBitDisplayer",render:function(){var t={position:"absolute",height:"100%",backgroundColor:"beige",width:this.props.timewidth,zIndex:"-1"},e={height:"100%",width:this.props.bitswidth,backgroundColor:"blueviolet",left:this.props.bitswidth*this.props.currentbit,position:"absolute"};return n.createElement("div",{className:"currentBitDisplayer",style:t},n.createElement("div",{style:e}))}});t.exports=s},95:function(t,e,i){"use strict";function n(){var t=l.getDrumKitInfos();return{bpm:t.bpm,time:t.time,bitnumber:t.bitnumber,instruments:t.instruments,elapsedtime:t.elapsedtime}}function s(){return{currentbit:l.getCurrentBit()}}function r(){return console.log("getGetBitPushed: "+l.getBitPushed()),{bitPushed:l.getBitPushed()}}function a(t){return b/t}function o(){return{elapsedtime:l.getCurrentTime()}}var c=i(13),u=i(25),l=i(56),h=i(98),m=i(99),d=i(96),p=i(100),f=i(94),b=6200,g=c.createClass({displayName:"DrumKit",getInitialState:function(){return n()},componentDidMount:function(){l.addChangedListener(this._onChange),l.addBitListener(this._onBitChange),l.addPausedsedTimeListener(this._OnTimeChanged),l.addBitPushedListener(this._OnBitPushed),u.loadDrumKit()},handleKeyPress:function(){switch(event.keyCode.toString()){case"104":u.changeBit(0,this.state.currentbit,1);break;case"107":u.changeBit(2,this.state.currentbit,1);break;case"115":u.changeBit(1,this.state.currentbit,1)}u.bitPushed(this.state.currentbit)},handleClick:function(){u.addItem("this is the item")},render:function(){console.log("DrumKitRender");var t={timeStyle:{width:b},tlcontent:{height:"8px",marginTop:"5px",marginBottom:"20px"}};return c.createElement("div",{className:"drumKit",onKeyPress:this.handleKeyPress},c.createElement("h3",{onClick:this.handleClick},"Load Audio Context"),c.createElement("div",{className:"instrumentInfosContent",style:{"float":"left"}},c.createElement("div",{className:"emptyTab",style:t.tlcontent}),c.createElement(m,{instruments:this.state.instruments})),c.createElement("div",{className:"notesContent",style:{"float":"left",maxWidth:"1000px",overflowX:"auto",position:"relative"}},c.createElement("div",{className:"timeLineContainer",style:t.timeStyle},c.createElement(p,{songTime:this.state.time,elapsedtime:this.state.elapsedtime,timeWidth:b,style:t.tlcontent})),c.createElement("div",{className:"InstrumentBitsListContainer",style:t.timeStyle},c.createElement(f,{timewidth:b,bitswidth:a(this.state.bitnumber),currentbit:this.state.currentbit}),c.createElement(h,{timeWidth:b,bitPushed:this.state.bitPushed,bitsWidth:a(this.state.bitnumber),instruments:this.state.instruments}))),c.createElement("div",{style:{clear:"both"}}),c.createElement("div",null,c.createElement(d,{elapsedtime:this.state.elapsedtime,bitnumber:this.state.bitnumber,bpm:this.state.bpm,time:this.state.time})))},_onChange:function(){this.setState(n())},_onBitChange:function(){this.setState(s())},_OnBitPushed:function(){this.setState(r())},_OnTimeChanged:function(){this.setState(o())}});t.exports=g},96:function(t,e,i){"use strict";var n=i(13),s=i(25),r=n.createClass({displayName:"DrumKitConsole",timeChange:function(t){s.timeChange(t.target.value)},bpmChange:function(t){s.bpmChange(t.target.value)},handlePlay:function(){s.playDrumKit(0)},handleStop:function(){s.stopDrumKit(0)},pausedTimeChange:function(t){s.pausedtimeChange(t.target.value)},render:function(){return n.createElement("div",{className:"drumKitConsole"},n.createElement("div",{className:"row"},n.createElement("form",{className:"form",role:"form"},n.createElement("div",{className:"col-xs-1"},n.createElement("label",{"for":"ex1"},"time:"),n.createElement("input",{type:"number",className:"form-control",step:"1",min:"0",id:"time",value:this.props.time,onChange:this.timeChange,"aria-describedby":"basic-addon3"})),n.createElement("div",{className:"col-xs-1"},n.createElement("label",{"for":"ex1"},"bpm:"),n.createElement("input",{type:"number",className:"form-control",step:"1",min:"0",id:"bpm",value:this.props.bpm,onChange:this.bpmChange,"aria-describedby":"basic-addon3"})),n.createElement("div",{className:"col-xs-1"},n.createElement("label",{"for":"ex1"},"bitnumber:"),n.createElement("input",{type:"number",className:"form-control",readOnly:!0,step:"1",min:"0",id:"bitnumber",value:this.props.bitnumber,"aria-describedby":"basic-addon3"})),n.createElement("div",{className:"col-xs-1"},n.createElement("label",{"for":"ex1"},"ElapsedTime:"),n.createElement("input",{type:"number",className:"form-control",min:"0",step:"any",value:this.props.elapsedtime,onChange:this.pausedTimeChange,id:"elapsedtime","aria-describedby":"basic-addon3"})))),n.createElement("div",{className:"row"},n.createElement("a",{href:"#",className:"btn btn-sm btn-default",onClick:this.handlePlay},n.createElement("span",{className:"glyphicon glyphicon-play"})," "),n.createElement("a",{href:"#",className:"btn btn-sm btn-default",onClick:this.handleStop},n.createElement("span",{className:"glyphicon glyphicon-stop"})," "),n.createElement("a",{href:"#",className:"btn btn-sm btn-default",onClick:this.handleStop},n.createElement("span",{className:"glyphicon glyphicon-pause"})," ")))}});t.exports=r},97:function(t,e,i){"use strict";function n(t){return 1==t?c:u}function s(t){var e=o.getBitsInstrument(t);return{bits:e}}var r=i(13),a=i(25),o=i(56),c={border:"1px solid silver",borderRadius:"5px",width:"40%",height:"80%",margin:"auto",background:"silver"},u={border:"1px solid silver",borderRadius:"5px",width:"40%",height:"80%",margin:"auto"},l=r.createClass({displayName:"InstrumentBits",getInitialState:function(){return{bits:o.getBitsInstrument(this.props.instindex)}},shouldComponentUpdate:function(t,e){return console.log("shouldComponentUpdate_bitPushed: "+this.props.bitPushed),console.log("shouldComponentUpdate_bitPushed_(nextState): "+t.bitPushed),console.log(this.state[t.bitPushed]!=e[t.bitPushed]),this.state[t.bitPushed]!=e[t.bitPushed]||this.props.bitsWidth!=t.bitsWidth},bitClicked:function(t){var e=$(t.target).parent().data("index"),i=$(t.target).parent().attr("data-bitvalue"),n=$(t.target).closest(".instrumentBits").data("index");a.bitPushed(e),1==parseInt(i)?a.changeBit(n,e,0):a.changeBit(n,e,1)},componentDidMount:function(){o.addBitUpdatedListener(this._onChange),s(this.props.instindex)},render:function(){console.log("InstrumentBits Render----------------------------------------");var t={instrumentBits:{height:"24px",outline:"1px solid",display:"table",width:this.props.timeWidth},instrumentBitsContent:{display:"table-cell",verticalAlign:"middle"},bitContentStyle:{"float":"left",outline:"1px solid silver",width:this.props.bitsWidth,height:"10"},bitIsPlayedStyle:{"float":"left",outline:"1px solid silver",width:this.props.bitsWidth,height:"10",background:"black"}},e=this.state.bits.map(function(e,i){return r.createElement("div",{style:t.bitContentStyle,"data-bitvalue":e,key:i,"data-index":i,onClick:this.bitClicked,className:"instrumentBit"},r.createElement("div",{style:n(e)}))}.bind(this));return r.createElement("div",{className:"instrumentBits",style:t.instrumentBits,"data-index":this.props.instindex},r.createElement("div",{style:t.instrumentBitsContent},e))},_onChange:function(){this.setState(o.getBitsInstrument(this.props.instindex))}});t.exports=l},98:function(t,e,i){"use strict";var n=i(13),s=i(97),r=i(25),a=n.createClass({displayName:"InstrumentsList",handleTimeMove:function(t){r.setCurrentTime(t.target.value)},render:function(){var t=this.props.instruments.map(function(t,e){return n.createElement(s,{bitPushed:this.props.bitPushed,timeWidth:this.props.timeWidth,bitsWidth:this.props.bitsWidth,key:e,instindex:e})}.bind(this));return n.createElement("div",{className:"instrumentBitsList"},t)}});t.exports=a},99:function(t,e,i){"use strict";var n=i(13),s=n.createClass({displayName:"InstrumentInfos",render:function(){var t=this.props.instruments.map(function(t,e){return n.createElement("div",{className:"instrumentName",key:e,style:{width:"24",height:"24",outline:"1px solid"}},n.createElement("img",{src:t.imgurl,alt:t.name,height:"24",width:"24"}))});return n.createElement("div",{className:"instrumentInfosList"},t)}});t.exports=s},100:function(t,e,i){"use strict";function n(t,e){return t/e}function s(t,e,i){return t/e*i}var r=i(13),a=r.createClass({displayName:"TimeLine",render:function(){for(var t={outline:"1px solid gray",width:n(this.props.timeWidth,this.props.songTime),height:"8","float":"left",display:"block"},e={height:"100%",background:"gray",width:s(this.props.timeWidth,this.props.songTime,this.props.elapsedtime)},i=[],a=0;a<this.props.songTime;a++)i.push(r.createElement("div",{key:a,style:t},r.createElement("span",{style:{fontSize:"xx-small"}},a)));return r.createElement("div",{className:"timeLine",style:this.props.style},r.createElement("div",{className:"progressBar",style:e}),i)}});t.exports=a},101:function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}var s=i(13),r=n(s),a=i(64),o=n(a),c=i(95);o["default"].render(r["default"].createElement(c,{url:"/api/getdrumkit"}),document.getElementById("main"))},102:function(t,e){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function s(t){return"number"==typeof t}function r(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!s(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,i,s,o,c,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(i=this._events[t],a(i))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:for(s=arguments.length,o=new Array(s-1),c=1;s>c;c++)o[c-1]=arguments[c];i.apply(this,o)}else if(r(i)){for(s=arguments.length,o=new Array(s-1),c=1;s>c;c++)o[c-1]=arguments[c];for(u=i.slice(),s=u.length,c=0;s>c;c++)u[c].apply(this,o)}return!0},i.prototype.addListener=function(t,e){var s;if(!n(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?r(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,r(this._events[t])&&!this._events[t].warned){var s;s=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,s&&s>0&&this._events[t].length>s&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){function i(){this.removeListener(t,i),s||(s=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var s=!1;return i.listener=e,this.on(t,i),this},i.prototype.removeListener=function(t,e){var i,s,a,o;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=this._events[t],a=i.length,s=-1,i===e||n(i.listener)&&i.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(r(i)){for(o=a;o-- >0;)if(i[o]===e||i[o].listener&&i[o].listener===e){s=o;break}if(0>s)return this;1===i.length?(i.length=0,delete this._events[t]):i.splice(s,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[t],n(i))this.removeListener(t,i);else for(;i.length;)this.removeListener(t,i[i.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.listenerCount=function(t,e){var i;return i=t._events&&t._events[e]?n(t._events[e])?1:t._events[e].length:0}},118:function(t,e,i){t.exports=i.p+"img/hihat.png"},119:function(t,e,i){t.exports=i.p+"img/kick.png"},120:function(t,e,i){t.exports=i.p+"img/snare.png"},121:function(t,e,i){t.exports=i.p+"img/tome1.png"},122:function(t,e,i){t.exports=i.p+"sounds/hihat.mp3"},123:function(t,e,i){t.exports=i.p+"sounds/kick.mp3"},124:function(t,e,i){t.exports=i.p+"sounds/snare.mp3"},125:function(t,e,i){t.exports=i.p+"sounds/tom1.mp3"},126:function(t,e,i){t.exports.Dispatcher=i(127)},127:function(t,e,i){(function(n){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var r=i(128),a="ID_",o=function(){function t(){s(this,t),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return t.prototype.register=function(t){var e=a+this._lastID++;return this._callbacks[e]=t,e},t.prototype.unregister=function(t){this._callbacks[t]?void 0:"production"!==n.env.NODE_ENV?r(!1,"Dispatcher.unregister(...): `%s` does not map to a registered callback.",t):r(!1),delete this._callbacks[t]},t.prototype.waitFor=function(t){this._isDispatching?void 0:"production"!==n.env.NODE_ENV?r(!1,"Dispatcher.waitFor(...): Must be invoked while dispatching."):r(!1);for(var e=0;e<t.length;e++){var i=t[e];this._isPending[i]?this._isHandled[i]?void 0:"production"!==n.env.NODE_ENV?r(!1,"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",i):r(!1):(this._callbacks[i]?void 0:"production"!==n.env.NODE_ENV?r(!1,"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",i):r(!1),this._invokeCallback(i))}},t.prototype.dispatch=function(t){this._isDispatching?"production"!==n.env.NODE_ENV?r(!1,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."):r(!1):void 0,this._startDispatching(t);try{for(var e in this._callbacks)this._isPending[e]||this._invokeCallback(e)}finally{this._stopDispatching()}},t.prototype.isDispatching=function(){return this._isDispatching},t.prototype._invokeCallback=function(t){this._isPending[t]=!0,this._callbacks[t](this._pendingPayload),this._isHandled[t]=!0},t.prototype._startDispatching=function(t){for(var e in this._callbacks)this._isPending[e]=!1,this._isHandled[e]=!1;this._pendingPayload=t,this._isDispatching=!0},t.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},t}();t.exports=o}).call(e,i(1))},128:function(t,e,i){(function(e){"use strict";var i=function(t,i,n,s,r,a,o,c){if("production"!==e.env.NODE_ENV&&void 0===i)throw new Error("invariant requires an error message argument");if(!t){var u;if(void 0===i)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,s,r,a,o,c],h=0;u=new Error("Invariant Violation: "+i.replace(/%s/g,function(){return l[h++]}))}throw u.framesToPop=1,u}};t.exports=i}).call(e,i(1))}});
//# sourceMappingURL=bundle.js.map